# ZZZ Seelie æ•°æ®åŒæ­¥è„šæœ¬

ä¸€ä¸ªä¸º [ZZZ Seelie](https://zzz.seelie.me/) ç½‘ç«™æä¾›æ•°æ®åŒæ­¥åŠŸèƒ½çš„æ²¹çŒ´è„šæœ¬ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ¯ Seelie é¢æ¿

- **ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º**: è‡ªåŠ¨è·å–å¹¶æ˜¾ç¤ºç”¨æˆ·æ˜µç§°ã€UID å’Œè¿æ¥çŠ¶æ€
- **ä¸€é”®åŒæ­¥**: æä¾›"åŒæ­¥å…¨éƒ¨"æŒ‰é’®ï¼Œå¿«é€ŸåŒæ­¥æ¸¸æˆæ•°æ®
- **çŠ¶æ€åé¦ˆ**: å®æ—¶æ˜¾ç¤ºåŒæ­¥è¿›åº¦å’Œç»“æœ
- **å“åº”å¼è®¾è®¡**: å®Œç¾é€‚é… Seelie ç½‘ç«™çš„æ·±è‰²ä¸»é¢˜

### ğŸ”§ æŠ€æœ¯ç‰¹æ€§

- **TypeScript**: å®Œæ•´çš„ç±»å‹å®‰å…¨æ”¯æŒ
- **æ¨¡å—åŒ–æ¶æ„**: æ¸…æ™°çš„ä»£ç ç»„ç»‡ç»“æ„
- **ç°ä»£åŒ– API**: ä½¿ç”¨ GM_fetch è¿›è¡Œç½‘ç»œè¯·æ±‚
- **æ™ºèƒ½ç¼“å­˜**: è®¾å¤‡ä¿¡æ¯å’Œç”¨æˆ·ä¿¡æ¯ç¼“å­˜æœºåˆ¶
- **å¼€å‘å‹å¥½**: å®Œæ•´çš„å¼€å‘å·¥å…·é“¾æ”¯æŒ

## å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
pnpm install
```

### å¼€å‘æ¨¡å¼

```bash
pnpm run dev
```

å¼€å‘æ¨¡å¼ä¼šè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨å¹¶æä¾›è„šæœ¬å®‰è£…é“¾æ¥ã€‚

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
pnpm run build
```

æ„å»ºå®Œæˆåï¼Œå®‰è£… `dist/zzz-seelie-sync.user.js` æ–‡ä»¶åˆ°ä½ çš„æ²¹çŒ´è„šæœ¬ç®¡ç†å™¨ã€‚

### ç±»å‹æ£€æŸ¥

```bash
pnpm run type-check
```

### ä»£ç æ£€æŸ¥

```bash
pnpm run lint
pnpm run lint:fix  # è‡ªåŠ¨ä¿®å¤
```

## ç‰ˆæœ¬å‘å¸ƒ

### è‡ªåŠ¨ç‰ˆæœ¬å·

é¡¹ç›®æ”¯æŒè‡ªåŠ¨ç‰ˆæœ¬å·ç®¡ç†ï¼š

- **å¼€å‘ç¯å¢ƒ**: ä½¿ç”¨ `git describe` ç”Ÿæˆç‰ˆæœ¬å·ï¼Œæ ¼å¼å¦‚ `1.0.0.6-g0230769`
- **CI æ„å»º**: å¤œé—´æ„å»ºä½¿ç”¨ git describeï¼Œæ­£å¼å‘å¸ƒä½¿ç”¨ package.json ç‰ˆæœ¬
- **æœ¬åœ°æ„å»º**: è‡ªåŠ¨æ£€æµ‹ git çŠ¶æ€ç”Ÿæˆç‰ˆæœ¬å·

### å‘å¸ƒæµç¨‹

#### 1. è‡ªåŠ¨å‘å¸ƒï¼ˆæ¨èï¼‰

```bash
# å‘å¸ƒè¡¥ä¸ç‰ˆæœ¬ (1.0.0 -> 1.0.1)
pnpm run release:patch

# å‘å¸ƒæ¬¡è¦ç‰ˆæœ¬ (1.0.0 -> 1.1.0)
pnpm run release:minor

# å‘å¸ƒä¸»è¦ç‰ˆæœ¬ (1.0.0 -> 2.0.0)
pnpm run release:major
```

#### 2. æ‰‹åŠ¨å‘å¸ƒ

```bash
# æ›´æ–°ç‰ˆæœ¬å·
npm version patch  # æˆ– minor, major

# æ¨é€æ ‡ç­¾
git push --tags
```

### GitHub Actions

é¡¹ç›®é…ç½®äº†å®Œæ•´çš„ CI/CD æµç¨‹ï¼š

#### CI å·¥ä½œæµ (`.github/workflows/ci.yml`)

- **è§¦å‘æ¡ä»¶**: æ¨é€åˆ° main åˆ†æ”¯æˆ–åˆ›å»º PR
- **æ‰§è¡Œæ­¥éª¤**:
  1. ç±»å‹æ£€æŸ¥å’Œä»£ç æ£€æŸ¥
  2. æ„å»ºè„šæœ¬
  3. éƒ¨ç½²åˆ° `release-nightly` åˆ†æ”¯ï¼ˆä»… main åˆ†æ”¯ï¼‰

#### Release å·¥ä½œæµ (`.github/workflows/release.yml`)

- **è§¦å‘æ¡ä»¶**: æ¨é€ `v*` æ ‡ç­¾
- **æ‰§è¡Œæ­¥éª¤**:
  1. æ„å»ºæ­£å¼ç‰ˆæœ¬
  2. éƒ¨ç½²åˆ° `release` åˆ†æ”¯
  3. åˆ›å»º GitHub Release
  4. ä¸Šä¼  `.user.js` æ–‡ä»¶ä½œä¸ºé™„ä»¶

### ç‰ˆæœ¬åˆ†æ”¯

- **`release-nightly`**: å¤œé—´æ„å»ºï¼ŒåŒ…å«æœ€æ–°å¼€å‘ç‰ˆæœ¬
- **`release`**: æ­£å¼å‘å¸ƒç‰ˆæœ¬ï¼Œä»…åŒ…å«æ ‡ç­¾ç‰ˆæœ¬

### å®‰è£…é“¾æ¥

- **ç¨³å®šç‰ˆæœ¬**: `https://raw.githubusercontent.com/owwkmidream/zzz-seelie-sync/refs/heads/release/zzz-seelie-sync.user.js`
- **å¼€å‘ç‰ˆæœ¬**: `https://raw.githubusercontent.com/owwkmidream/zzz-seelie-sync/refs/heads/release-nightly/zzz-seelie-sync.user.js`

## é¡¹ç›®ç»“æ„

```
userscripts/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/hoyo/           # ç±³å“ˆæ¸¸ API ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ client.ts       # API å®¢æˆ·ç«¯æ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ types.ts        # ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ avatar.ts       # è§’è‰²ç›¸å…³ API
â”‚   â”‚   â”œâ”€â”€ game-note.ts    # æ¸¸æˆä¾¿ç¬º API
â”‚   â”‚   â”œâ”€â”€ utils.ts        # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ index.ts        # ç»Ÿä¸€å¯¼å‡º
â”‚   â”œâ”€â”€ components/         # UI ç»„ä»¶
â”‚   â”‚   â””â”€â”€ SeeliePanel.ts  # Seelie é¢æ¿ç»„ä»¶
â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ logger.ts       # æ—¥å¿—å·¥å…·
â”‚   â”‚   â”œâ”€â”€ vnodeTraverser.ts # VNode éå†
â”‚   â”‚   â”œâ”€â”€ useRouterWatcher.ts # è·¯ç”±ç›‘å¬
â”‚   â”‚   â””â”€â”€ seelie/         # Seelie ç›¸å…³å·¥å…·
â”‚   â”œâ”€â”€ app.ts              # åº”ç”¨ä¸»é€»è¾‘
â”‚   â”œâ”€â”€ main.ts             # å…¥å£æ–‡ä»¶
â”‚   â””â”€â”€ vite-env.d.ts       # ç±»å‹å£°æ˜
â”œâ”€â”€ docs/                   # æ–‡æ¡£
â”œâ”€â”€ dist/                   # æ„å»ºè¾“å‡º
â”œâ”€â”€ vite.config.ts          # Vite é…ç½®
â”œâ”€â”€ tsconfig.*.json         # TypeScript é…ç½®
â””â”€â”€ package.json            # é¡¹ç›®é…ç½®
```

## ä½¿ç”¨è¯´æ˜

### å®‰è£…è„šæœ¬

1. ç¡®ä¿å·²å®‰è£…æ²¹çŒ´è„šæœ¬ç®¡ç†å™¨ï¼ˆå¦‚ Tampermonkeyï¼‰
2. æ„å»ºé¡¹ç›®ï¼š`pnpm run build`
3. å®‰è£…ç”Ÿæˆçš„ `dist/zzz-seelie-sync.user.js` æ–‡ä»¶
4. è®¿é—® https://zzz.seelie.me/ å³å¯çœ‹åˆ° Seelie é¢æ¿

### é¢æ¿åŠŸèƒ½

- **ç”¨æˆ·ä¿¡æ¯**: æ˜¾ç¤ºå½“å‰ç™»å½•ç”¨æˆ·çš„æ˜µç§°å’Œ UID
- **è¿æ¥çŠ¶æ€**: ç»¿ç‚¹è¡¨ç¤ºå·²è¿æ¥ï¼Œçº¢ç‚¹è¡¨ç¤ºè¿æ¥å¤±è´¥
- **åŒæ­¥å…¨éƒ¨**: ç‚¹å‡»æŒ‰é’®åŒæ­¥æ‰€æœ‰æ¸¸æˆæ•°æ®ï¼ˆå½“å‰ä¸ºæµ‹è¯•ç‰ˆæœ¬ï¼‰
- **è®¾ç½®**: å¿«é€Ÿè®¿é—®è„šæœ¬è®¾ç½®ï¼ˆå¾…å®ç°ï¼‰

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½

1. åœ¨ç›¸åº”ç›®å½•ä¸‹åˆ›å»ºæ–°æ–‡ä»¶
2. ä½¿ç”¨ TypeScript ç¼–å†™ä»£ç 
3. å¯¼å…¥åˆ° `app.ts` ä¸­è¿›è¡Œåˆå§‹åŒ–
4. è¿è¡Œç±»å‹æ£€æŸ¥ç¡®ä¿æ— è¯¯

### æ ·å¼å¼€å‘

- ä½¿ç”¨ Tailwind CSS ç±»å
- ä¿æŒä¸ Seelie ç½‘ç«™é£æ ¼ä¸€è‡´
- æ”¯æŒæ·±è‰²ä¸»é¢˜

### API å¼€å‘

- æ‰€æœ‰ API è¯·æ±‚ä½¿ç”¨ `@trim21/gm-fetch`
- éµå¾ªç±³å“ˆæ¸¸ API è§„èŒƒ
- å®ç°é€‚å½“çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **é¢æ¿æœªæ˜¾ç¤º**: æ£€æŸ¥æ§åˆ¶å°é”™è¯¯ï¼Œç¡®è®¤ç›®æ ‡å®¹å™¨å­˜åœ¨
2. **ç”¨æˆ·ä¿¡æ¯åŠ è½½å¤±è´¥**: æ£€æŸ¥ Cookie æœ‰æ•ˆæ€§å’Œç½‘ç»œè¿æ¥
3. **æ„å»ºå¤±è´¥**: è¿è¡Œ `pnpm run type-check` æ£€æŸ¥ç±»å‹é”™è¯¯

### è°ƒè¯•æŠ€å·§

- ä½¿ç”¨ `logger.debug()` è¾“å‡ºè°ƒè¯•ä¿¡æ¯ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰
- æ£€æŸ¥æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ç½‘ç»œé¢æ¿
- æŸ¥çœ‹æ²¹çŒ´è„šæœ¬ç®¡ç†å™¨çš„æ—¥å¿—

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. åˆ›å»º Pull Request

## è®¸å¯è¯

MIT License

## æ›´æ–°æ—¥å¿—

### v1.0.0

- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- Seelie é¢æ¿ç»„ä»¶
- ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
- åŸºç¡€åŒæ­¥åŠŸèƒ½
